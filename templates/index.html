<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Smart Task Scheduler</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root{
            --bg:#0f1724;
            --card:#0b1220;
            --muted:#9aa6bc;
            --accent:#5eead4;
            --accent-2:#7dd3fc;
            --danger:#ff6b6b;
            --glass: rgba(255,255,255,0.04);
            --radius:12px;
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            background: linear-gradient(180deg,#071127 0%, #0a1222 60%);
            color:#e6eef8;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            padding:28px;
        }

        .container{
            max-width:1100px;
            margin:0 auto;
            display:grid;
            grid-template-columns: 1fr 420px;
            gap:22px;
        }

        header{
            grid-column:1 / -1;
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:16px;
            margin-bottom:6px;
        }
        .brand{
            display:flex;
            gap:12px;
            align-items:center;
        }
        .logo{
            width:56px;
            height:56px;
            border-radius:12px;
            background: linear-gradient(135deg,var(--accent),var(--accent-2));
            display:flex;
            align-items:center;
            justify-content:center;
            font-weight:700;
            color:#042027;
            box-shadow: 0 6px 20px rgba(124,58,237,0.08), inset 0 -6px 20px rgba(255,255,255,0.03);
            font-size:20px;
        }
        h1{font-size:20px;margin:0}
        p.lead{color:var(--muted);margin:0;font-size:13px}

        .card{
            background: linear-gradient(180deg, rgba(255,255,255,0.02), var(--glass));
            border-radius:var(--radius);
            padding:18px;
            box-shadow: 0 8px 30px rgba(2,6,23,0.6);
        }

        /* Form (right column) */
        form .field{
            display:flex;
            gap:8px;
            margin-bottom:10px;
            align-items:center;
        }
        label{font-size:13px;color:var(--muted);min-width:90px}
        input[type="text"], input[type="number"], input[type="datetime-local"]{
            background:transparent;
            border:1px solid rgba(255,255,255,0.06);
            color:var(--muted);
            padding:9px 10px;
            border-radius:8px;
            width:100%;
            outline:none;
        }
        input:focus{border-color:rgba(125,211,252,0.22); box-shadow:0 0 0 4px rgba(125,211,252,0.04); color:#e6eef8}
        .muted-sm{font-size:12px;color:var(--muted);}

        .btn{
            display:inline-block;
            background:linear-gradient(90deg,var(--accent),var(--accent-2));
            color:#022; padding:10px 14px;
            border-radius:10px;
            text-decoration:none;
            border:none;
            cursor:pointer;
            font-weight:600;
            box-shadow: 0 6px 18px rgba(45,212,191,0.12);
        }
        .btn.ghost{
            background:transparent;
            border:1px solid rgba(255,255,255,0.06);
            color:var(--muted);
            box-shadow:none;
        }

        /* Tasks list (left column) */
        .controls{
            display:flex;
            gap:8px;
            align-items:center;
            margin-bottom:12px;
        }
        .search{
            flex:1;
            position:relative;
        }
        .search input{
            width:100%;
            padding:10px 12px;
            border-radius:10px;
            border:1px solid rgba(255,255,255,0.04);
            background:transparent;
            color:var(--muted);
        }

        table{
            width:100%;
            border-collapse:collapse;
            margin-top:6px;
            color:var(--muted);
            font-size:14px;
        }
        thead th{
            text-align:left;
            font-size:12px;
            color:var(--muted);
            padding:12px 10px;
            background:transparent;
            border-bottom:1px solid rgba(255,255,255,0.04);
        }
        tbody tr{
            transition:transform .15s ease, background .15s ease;
        }
        tbody tr:hover{ transform:translateY(-4px); }
        td{
            padding:12px 10px;
            vertical-align:middle;
            border-bottom:1px dashed rgba(255,255,255,0.02);
        }

        .tag{
            display:inline-block;
            padding:6px 8px;
            border-radius:999px;
            font-size:12px;
            font-weight:600;
            color:#022;
            background:linear-gradient(90deg,var(--accent),var(--accent-2));
        }
        .priority-1{ background:#fde68a; color:#3b2b00 }
        .priority-2{ background:#ffb687; color:#3b1b00 }
        .priority-3{ background:#ffd6a5; color:#3b2100 }
        .priority-4{ background:#ff9aa2; color:#3b0f12 }
        .priority-5{ background:#ff6b6b; color:#2b0202 }

        .completed { background: linear-gradient(90deg, rgba(16,185,129,0.08), rgba(16,185,129,0.035)); }
        .status{
            font-weight:700;
            display:inline-flex;
            gap:8px;
            align-items:center;
        }

        .actions a{
            text-decoration:none;
            color:var(--accent-2);
            font-weight:600;
            padding:6px 8px;
            border-radius:8px;
            background:transparent;
            border:1px solid rgba(125,211,252,0.06);
        }

        footer{
            grid-column:1 / -1;
            margin-top:18px;
            color:var(--muted);
            font-size:13px;
            text-align:center;
        }

        /* Responsive */
        @media (max-width:980px){
            .container{ grid-template-columns: 1fr; padding:8px; }
            header{ flex-direction:column; align-items:flex-start; gap:8px }
        }
        tr.removed {
            opacity: 0;
            transform: translateX(16px) scale(0.995);
            transition: all 220ms ease;
        }
        tr { transition: all 220ms ease; }
    </style>
</head>
<body>
    <div class="container">

        <header>
            <div class="brand">
                <div class="logo">STS</div>
                <div>
                    <h1>Smart Task Scheduler</h1>
                    <p class="lead">Prioritize, schedule and finish tasks with ease</p>
                </div>
            </div>

            <div style="display:flex;gap:10px;align-items:center">
                <a class="btn" href="/">Refresh</a>
                <a class="btn ghost" href="/remove_completed">Remove Completed</a>
            </div>
        </header>

        <section class="card" aria-labelledby="tasks-title">
            <h3 id="tasks-title" style="margin:0 0 8px 0">Tasks</h3>

            <div class="controls">
                <div class="search">
                    <input placeholder="Search tasks by name..." type="text" oninput="filterTasks(this.value)" />
                </div>
                <div class="muted-sm">Total: <strong>{{ tasks|length }}</strong></div>
            </div>

            <div style="overflow:auto; max-height:62vh; padding-right:6px;">
                <table role="table" aria-label="Tasks table">
                    <thead>
                        <tr>
                            <th style="width:36px">#</th>
                            <th>Name</th>
                            <th style="width:120px">Priority</th>
                            <th style="width:160px">Deadline</th>
                            <th style="width:120px">Duration</th>
                            <th style="width:120px">Status</th>
                            <th style="width:120px">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tasks-body">
                       {% for task in tasks %}
<tr class="{{ 'completed' if task.completed else '' }}" data-name="{{ task.name|lower }}">
    <td>{{ loop.index0 + 1 }}</td>
    <td style="font-weight:600;color:#e6eef8">{{ task.name }}</td>
    <td>
        <span class="tag priority-{{ task.priority }}">{{ task.priority }}</span>
    </td>
    <td>{{ task.deadline.strftime("%d/%m/%Y %H:%M") }}</td>
    <td>{{ (task.duration*60)|int }} min</td>
    <td>
        <div class="status">
            {% if task.completed %}
                <span style="color:var(--accent-2);font-weight:700">Completed</span>
            {% else %}
                <span style="color:var(--muted);font-weight:700">Pending</span>
            {% endif %}
        </div>
    </td>
    <td class="actions">
        {% if not task.completed %}
            <a href="/complete/{{ loop.index0 }}" title="Mark task completed">Mark</a>
        {% else %}
            <!-- Remove single completed task (fade out effect) -->
            <a class="btn ghost" href="/remove/{{ loop.index0 }}" onclick="removeTask(this,event)" title="Remove this task">Remove</a>
        {% endif %}
    </td>
</tr>
{% endfor %}
                    </tbody>
                </table>
            </div>
        </section>

        <aside class="card" aria-labelledby="add-title">
            <h3 id="add-title" style="margin:0 0 10px 0">Add New Task</h3>

            <form method="POST" action="/add" style="display:grid;gap:8px;">
                <div class="field">
                    <label for="name">Name</label>
                    <input id="name" name="name" type="text" required placeholder="E.g. Write report">
                </div>

                <div class="field">
                    <label for="priority">Priority</label>
                    <input id="priority" name="priority" type="number" min="1" max="5" required value="3">
                </div>

                <div class="field">
                    <label for="deadline">Deadline</label>
                    <input id="deadline" name="deadline" type="text" required placeholder="dd/mm/yyyy hh:mm">
                </div>

                <div class="field">
                    <label for="hours">Hours</label>
                    <input id="hours" name="hours" type="number" min="0" value="0">
                </div>

                <div class="field">
                    <label for="minutes">Minutes</label>
                    <input id="minutes" name="minutes" type="number" min="0" value="0">
                </div>

                <div style="display:flex;gap:8px;margin-top:6px">
                    <button class="btn" type="submit">Add Task</button>
                    <a class="btn ghost" href="/" role="button">Cancel</a>
                </div>
            </form>

            <div style="margin-top:12px;color:var(--muted);font-size:13px">
                Tip: Use priority 1 (highest) — 5 (lowest). Click "Mark" to complete a task.
            </div>
        </aside>

        <footer>
            <div>Built for productivity • Small, focused UI • Dark Thunder</div>
        </footer>
    </div>

    <script>
        function removeTask(el, ev){
            ev.preventDefault();
            const tr = el.closest('tr');
            if(!tr) { window.location = el.href; return; }
            tr.classList.add('removed');
            // small delay to show the effect, then navigate
            setTimeout(() => { window.location = el.href; }, 220);
        }

         function filterTasks(q){
            q = (q || '').trim().toLowerCase();
            const rows = document.querySelectorAll('#tasks-body tr');
            rows.forEach(r=>{
                const name = r.getAttribute('data-name') || '';
                r.style.display = (!q || name.includes(q)) ? '' : 'none';
            });
        }
    </script>
</body>
</html>
